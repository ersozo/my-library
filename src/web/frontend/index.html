<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ“š KÃ¼tÃ¼phane YÃ¶netim Sistemi</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
</head>
<body class="bg-gray-200 min-h-screen pt-20">
    <div x-data="libraryApp()">
        <header class="fixed top-0 left-0 right-0 bg-blue-600 shadow-lg border-b border-gray-200 z-50">
            <div class="container mx-auto px-4 py-4">
                <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-4">
                        <div class="flex items-center space-x-2">
                            <span class="text-2xl">ğŸ“š</span>
                            <h1 class="text-3xl font-bold text-white">KÃ¼tÃ¼phane YÃ¶netim Sistemi</h1>
                        </div>
                    </div>
                    <div class="flex items-center space-x-4">
                        <div class="bg-blue-50 px-4 py-2 rounded-lg border border-blue-200">
                            <span class="text-blue-800 font-medium text-md">ğŸ“Š Ä°statistikler</span>
                            <div class="text-s text-blue-600 mt-1" x-text="statsText"></div>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <main class="container mx-auto px-4 py-8">
            <!-- Mesajlar -->
            <div x-show="message" x-transition class="mb-6">
                <div :class="messageClass" class="p-4 rounded-lg shadow-sm">
                    <p x-text="message"></p>
                </div>
            </div>

            <!-- Manuel kitap ekleme -->
            <div class="bg-white rounded-lg shadow-md p-6 mb-8">
                <h2 class="text-2xl font-semibold text-gray-800 mb-6">â• Manuel Kitap Ekle</h2>
                <form @submit.prevent="addBook" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                    <div>
                        <label for="title" class="block text-sm font-medium text-gray-700 mb-2">Kitap BaÅŸlÄ±ÄŸÄ±</label>
                        <input
                            type="text"
                            id="title"
                            x-model="bookForm.title"
                            required
                            placeholder="Kitap baÅŸlÄ±ÄŸÄ±"
                            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>

                    <div>
                        <label for="author" class="block text-sm font-medium text-gray-700 mb-2">Yazar</label>
                        <input
                            type="text"
                            id="author"
                            x-model="bookForm.author"
                            required
                            placeholder="Yazar adÄ±"
                            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>

                    <div>
                        <label for="isbn" class="block text-sm font-medium text-gray-700 mb-2">ISBN</label>
                        <input
                            type="text"
                            id="isbn"
                            x-model="bookForm.isbn"
                            required
                            minlength="10"
                            maxlength="13"
                            placeholder="ISBN numarasÄ±"
                            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>

                    <div>
                        <label for="year" class="block text-sm font-medium text-gray-700 mb-2">YayÄ±n YÄ±lÄ±</label>
                        <input
                            type="number"
                            id="year"
                            x-model="bookForm.publication_year"
                            required
                            min="1401"
                            max="2030"
                            placeholder="2024"
                            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>

                    <div class="md:col-span-2 lg:col-span-4">
                        <button
                            type="submit"
                            :disabled="bookForm.loading"
                            class="bg-blue-600 text-white px-6 py-2 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50">
                            <span x-show="!bookForm.loading">ğŸ“– Kitap Ekle</span>
                            <span x-show="bookForm.loading">â³ Ekleniyor...</span>
                        </button>
                    </div>
                </form>
            </div>

            <!-- ISBN ile kitap ekleme -->
            <div class="bg-white rounded-lg shadow-md p-6 mb-8">
                <h2 class="text-2xl font-semibold text-gray-800 mb-6">ğŸ”¢ ISBN ile HÄ±zlÄ± Kitap Ekle</h2>
                <p class="text-gray-600 mb-4">ISBN numarasÄ±nÄ± girerek kitap bilgilerini otomatik olarak bulabilir ve ekleyebilirsiniz.</p>
                <form @submit.prevent="addBookByIsbn" class="flex flex-wrap gap-4">
                    <div class="flex-1 min-w-64">
                        <label for="isbnOnly" class="block text-sm font-medium text-gray-700 mb-2">ISBN NumarasÄ±</label>
                        <input
                            type="text"
                            id="isbnOnly"
                            x-model="isbnForm.isbn"
                            required
                            minlength="10"
                            maxlength="13"
                            placeholder="ISBN numarasÄ±nÄ± girin (Ã¶rn: 9780134685991)"
                            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500">
                    </div>
                    <div class="self-end">
                        <button
                            type="submit"
                            :disabled="isbnForm.loading"
                            class="bg-green-600 text-white px-6 py-2 rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 disabled:opacity-50">
                            <span x-show="!isbnForm.loading">ğŸš€ Otomatik Ekle</span>
                            <span x-show="isbnForm.loading">â³ Ekleniyor...</span>
                        </button>
                    </div>
                </form>
                <div class="mt-4 text-sm text-gray-500">
                    ğŸ’¡ <strong>NasÄ±l Ã§alÄ±ÅŸÄ±r:</strong> ISBN numarasÄ±nÄ± girdiÄŸinizde, sistem kitap bilgilerini (baÅŸlÄ±k, yazar) otomatik olarak bulup SQLite veritabanÄ±na kaydeder.
                </div>
            </div>

            <!-- Kitap arama/bulma -->
            <div class="bg-white rounded-lg shadow-md p-6 mb-8">
                <h2 class="text-2xl font-semibold text-gray-800 mb-6">ğŸ” Kitap Ara</h2>
                <p class="text-gray-600 mb-4">Mevcut kitaplarÄ± baÅŸlÄ±k, yazar veya ISBN numarasÄ±na gÃ¶re arayabilirsiniz.</p>

                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                    <div>
                        <label for="searchTitle" class="block text-sm font-medium text-gray-700 mb-2">BaÅŸlÄ±k</label>
                        <input
                            type="text"
                            id="searchTitle"
                            x-model="searchForm.title"
                            placeholder="Kitap baÅŸlÄ±ÄŸÄ±"
                            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500">
                    </div>

                    <div>
                        <label for="searchAuthor" class="block text-sm font-medium text-gray-700 mb-2">Yazar</label>
                        <input
                            type="text"
                            id="searchAuthor"
                            x-model="searchForm.author"
                            placeholder="Yazar adÄ±"
                            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500">
                    </div>

                    <div>
                        <label for="searchISBN" class="block text-sm font-medium text-gray-700 mb-2">ISBN</label>
                        <input
                            type="text"
                            id="searchISBN"
                            x-model="searchForm.isbn"
                            placeholder="ISBN numarasÄ±"
                            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500">
                    </div>
                </div>

                <div class="flex gap-4 mb-6">
                    <button
                        @click="searchBooks"
                        :disabled="searchForm.loading"
                        class="bg-purple-600 text-white px-6 py-2 rounded-md hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-purple-500 disabled:opacity-50">
                        <span x-show="!searchForm.loading">ğŸ” Ara</span>
                        <span x-show="searchForm.loading">â³ AranÄ±yor...</span>
                    </button>

                    <button
                        @click="clearSearch"
                        class="bg-gray-500 text-white px-4 py-2 rounded-md hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-gray-500">
                        ğŸ—‘ï¸ Temizle
                    </button>
                </div>

                <!-- Arama sonuÃ§larÄ± -->
                <div x-show="searchResults.length > 0" x-transition class="border-t pt-6">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">ğŸ“‹ Arama SonuÃ§larÄ±</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                        <template x-for="book in searchResults" :key="book.isbn">
                            <div class="border border-purple-200 rounded-lg p-4 bg-purple-50">
                                <div class="flex items-start justify-between mb-3">
                                    <div class="flex-1">
                                        <h4 class="font-semibold text-gray-800 mb-1" x-text="book.title"></h4>
                                        <p class="text-gray-600 text-sm mb-1" x-text="'Yazar: ' + book.author"></p>
                                        <p class="text-gray-500 text-xs" x-text="'ISBN: ' + book.isbn"></p>
                                    </div>
                                    <div class="ml-4">
                                        <span
                                            :class="book.borrowed ? 'bg-red-100 text-red-800' : 'bg-green-100 text-green-800'"
                                            class="px-2 py-1 rounded-full text-xs font-medium"
                                            x-text="book.borrowed ? 'ğŸ”´ Ã–dÃ¼nÃ§' : 'ğŸŸ¢ Mevcut'">
                                        </span>
                                    </div>
                                </div>

                                <div class="grid grid-cols-2 gap-2">
                                    <button
                                        @click="toggleBorrow(book.isbn, book.borrowed)"
                                        :class="book.borrowed ? 'bg-green-600 hover:bg-green-700' : 'bg-yellow-600 hover:bg-yellow-700'"
                                        class="text-white px-3 py-1 rounded text-sm font-medium">
                                        <span x-text="book.borrowed ? 'â†©ï¸ Ä°ade Et' : 'ğŸ“¤ Ã–dÃ¼nÃ§ Al'"></span>
                                    </button>

                                    <button
                                        @click="removeBook(book.isbn)"
                                        class="bg-red-600 text-white px-3 py-1 rounded text-sm font-medium hover:bg-red-700">
                                        ğŸ—‘ï¸ Sil
                                    </button>
                                </div>
                            </div>
                        </template>
                    </div>
                </div>

                <div x-show="searchResults.length === 0 && searchPerformed" x-transition class="border-t pt-6">
                    <div class="text-center py-8">
                        <div class="text-gray-400 text-4xl mb-4">ğŸ”</div>
                        <p class="text-gray-500">Arama kriterlerine uygun kitap bulunamadÄ±.</p>
                    </div>
                </div>
            </div>

            <!-- Kitap listesi -->
            <div class="bg-white rounded-lg shadow-md p-6">
                <div class="flex items-center justify-between mb-6">
                    <h2 class="text-2xl font-semibold text-gray-800">ğŸ“š Kitap Listesi</h2>
                    <button
                        @click="loadBooks"
                        class="bg-gray-600 text-white px-6 py-2 rounded-md hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-500">
                        ğŸ”„ Yenile
                    </button>
                </div>

                <div x-show="books.length === 0" class="text-center py-12">
                    <div class="text-gray-400 text-6xl mb-4">ğŸ“š</div>
                    <p class="text-gray-500">HenÃ¼z kitap eklenmemiÅŸ. YukarÄ±daki formlarÄ± kullanarak kitap ekleyebilirsiniz.</p>
                </div>

                <div x-show="books.length > 0" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                    <template x-for="book in books" :key="book.isbn">
                        <div class="border border-gray-200 rounded-lg p-4 hover:shadow-lg transition-shadow bg-gray-100">
                            <div class="flex items-start justify-between mb-3">
                                <div class="flex-1">
                                    <h3 class="font-semibold text-gray-800 mb-1" x-text="book.title"></h3>
                                    <p class="text-gray-600 text-sm mb-2" x-text="'Yazar: ' + book.author"></p>
                                    <p class="text-gray-500 text-xs" x-text="'ISBN: ' + book.isbn"></p>
                                </div>
                                <div class="ml-4">
                                    <span
                                        :class="book.borrowed ? 'bg-red-100 text-red-800' : 'bg-green-100 text-green-800'"
                                        class="px-2 py-1 rounded-full text-xs font-medium"
                                        x-text="book.borrowed ? 'ğŸ”´ Ã–dÃ¼nÃ§' : 'ğŸŸ¢ Mevcut'">
                                    </span>
                                </div>
                            </div>

                            <div class="grid grid-cols-2 gap-2">
                                <button
                                    @click="toggleBorrow(book.isbn, book.borrowed)"
                                    :class="book.borrowed ? 'bg-green-600 hover:bg-green-700' : 'bg-yellow-600 hover:bg-yellow-700'"
                                    class="text-white px-3 py-1 rounded text-sm font-medium">
                                    <span x-text="book.borrowed ? 'â†©ï¸ Ä°ade Et' : 'ğŸ“¤ Ã–dÃ¼nÃ§ Al'"></span>
                                </button>

                                <button
                                    @click="removeBook(book.isbn)"
                                    class="bg-red-600 text-white px-3 py-1 rounded text-sm font-medium hover:bg-red-700">
                                    ğŸ—‘ï¸ Sil
                                </button>
                            </div>
                        </div>
                    </template>
                </div>
            </div>
        </main>
    </div>

    <script src="app.js"></script>
</body>
</html>
